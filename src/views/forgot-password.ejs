<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forgot Password - GistAI</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="/css/landing.css">
    <link rel="stylesheet" href="/css/auth.css">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
</head>

<body>
    <!-- Background Animation -->
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1;">
        <canvas id="bg-canvas"></canvas>
    </div>

    <!-- Language Selector -->
    <div class="lang-selector" style="position: absolute; top: 20px; right: 20px; z-index: 100;">
        <button class="lang-btn" id="lang-toggle" aria-label="Select Language">
            <span id="current-lang-flag">ðŸ‡¬ðŸ‡§</span>
            <span>EN</span>
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor">
                <path d="M3 4.5L6 7.5L9 4.5" stroke-width="1.5" />
            </svg>
        </button>
        <div class="lang-dropdown" id="lang-dropdown">
            <div class="lang-option" data-lang="en">ðŸ‡¬ðŸ‡§ English</div>
            <div class="lang-option" data-lang="tr">ðŸ‡¹ðŸ‡· TÃ¼rkÃ§e</div>
            <div class="lang-option" data-lang="es">ðŸ‡ªðŸ‡¸ EspaÃ±ol</div>
            <div class="lang-option" data-lang="de">ðŸ‡©ðŸ‡ª Deutsch</div>
            <div class="lang-option" data-lang="fr">ðŸ‡«ðŸ‡· FranÃ§ais</div>
        </div>
    </div>

    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <a href="/" class="auth-logo">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" class="logo-icon" stroke="currentColor"
                        stroke-width="2">
                        <path
                            d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7V5.73C9.4 5.39 9 4.74 9 4a2 2 0 0 1 2-2z" />
                        <path d="M8 11h.01" />
                        <path d="M16 11h.01" />
                        <path d="M9 16c.5 1 2 1 2.5 1s2-1 2.5-1" />
                    </svg>
                </a>
                <h1 class="auth-title" data-i18n="auth.resetTitle">Reset Password</h1>
                <p class="auth-subtitle" data-i18n="auth.resetSubtitle">Enter your email to receive reset instructions
                </p>
            </div>

            <form id="forgotForm" class="auth-form">
                <div class="form-group">
                    <label for="email" class="form-label" data-i18n="auth.email">Email</label>
                    <input type="email" id="email" class="form-input" required>
                </div>

                <div class="error-message" id="errorMessage" style="display: none;"></div>
                <div class="success-message" id="successMessage"
                    style="color: #4ade80; text-align: center; margin-bottom: 20px; display: none;"></div>

                <button type="submit" class="auth-button" id="submitBtn">
                    <span class="btn-text" data-i18n="auth.sendLink">Send Reset Link</span>
                    <div class="loader"></div>
                </button>
            </form>

            <div class="auth-footer">
                <span data-i18n="auth.rememberPassword">Remember password?</span>
                <a href="/login" class="auth-link" data-i18n="auth.loginBtn">Login</a>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/js/i18n.js"></script>
    <script src="/js/landing.js"></script>
    <script>
        const form = document.getElementById('forgotForm');
        const errorMsg = document.getElementById('error-message');
        const successMsg = document.getElementById('success-message');
        const submitBtn = document.getElementById('submitBtn');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const email = document.getElementById('email').value;

            errorMsg.style.display = 'none';
            successMsg.style.display = 'none';
            submitBtn.textContent = 'Sending...';
            submitBtn.disabled = true;

            try {
                const response = await fetch('/api/auth/forgot-password', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                });

                const data = await response.json();

                if (response.ok) {
                    successMsg.textContent = 'Check your email for reset instructions.';
                    successMsg.style.display = 'flex';
                    submitBtn.textContent = 'Email Sent';
                } else {
                    errorMsg.textContent = data.error || 'Request failed';
                    errorMsg.style.display = 'flex';
                    submitBtn.textContent = 'Send Reset Link';
                    submitBtn.disabled = false;
                }
            } catch (err) {
                errorMsg.textContent = 'An error occurred. Please try again.';
                errorMsg.style.display = 'flex';
                submitBtn.textContent = 'Send Reset Link';
                submitBtn.disabled = false;
            }
        });
    </script>
</body>

</html>